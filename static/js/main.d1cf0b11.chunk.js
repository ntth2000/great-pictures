(this["webpackJsonpdeploy-github"]=this["webpackJsonpdeploy-github"]||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports={welcome:"Welcome_welcome__2Z7p5",header:"Welcome_header__2-CML",nav:"Welcome_nav__3k8ei",welcomeButton:"Welcome_welcomeButton__OuKxc",body:"Welcome_body__bdSFy",footer:"Welcome_footer__2Qr6M"}},function(e,t,n){"use strict";var r=n(18),c=n(3),s=n.n(c),a=n(10),o=n(9),i=n(1);function u(e,t){return"SEND"===t.type?{data:null,error:null,status:"pending"}:"SUCCESS"===t.type?{data:t.responseData,error:null,status:"completed"}:"ERROR"===t.type?{data:null,error:t.errorMessage,status:"completed"}:e}t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(i.useReducer)(u,{data:null,error:null,status:t?"pending":null}),c=Object(o.a)(n,2),l=c[0],j=c[1],d=Object(i.useCallback)(function(){var t=Object(a.a)(s.a.mark((function t(n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j({type:"SEND"}),t.prev=1,t.next=4,e(n);case 4:r=t.sent,j({type:"SUCCESS",responseData:r}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),j({type:"ERROR",errorMessage:t.t0.message||"Something went wrong!"});case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),[e]);return Object(r.a)({sendRequest:d},l)}},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return y}));var r=n(18),c=n(3),s=n.n(c),a=n(10),o="https://great-picture-dc893-default-rtdb.asia-southeast1.firebasedatabase.app";function i(e){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/users.json"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,n.ok){e.next=8;break}throw new Error(r.message||"Could not register.");case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return j.apply(this,arguments)}function j(){return(j=Object(a.a)(s.a.mark((function e(t){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/users.json"));case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,n.ok){e.next=8;break}throw new Error(r.message||"Could not fetch user.");case 8:e.t0=s.a.keys(r);case 9:if((e.t1=e.t0()).done){e.next=15;break}if(c=e.t1.value,r[c].email!==t){e.next=13;break}return e.abrupt("return",c);case 13:e.next=9;break;case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return b.apply(this,arguments)}function b(){return(b=Object(a.a)(s.a.mark((function e(t){var n,c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/users/").concat(t,".json"));case 2:return n=e.sent,e.next=5,n.json();case 5:if(c=e.sent,n.ok){e.next=8;break}throw new Error(c.message||"Could not fetch user.");case 8:return a=Object(r.a)({id:t},c),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=Object(a.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/pictures.json"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,n.ok){e.next=8;break}throw new Error(r.message||"Could not create picture.");case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return x.apply(this,arguments)}function x(){return(x=Object(a.a)(s.a.mark((function e(){var t,n,c,a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/pictures.json"));case 2:return t=e.sent,e.next=5,t.json();case 5:if(n=e.sent,t.ok){e.next=8;break}throw new Error(n.message||"Could not fetch pictures.");case 8:for(a in c=[],n)i=Object(r.a)({id:a},n[a]),c.unshift(i);return e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return m.apply(this,arguments)}function m(){return(m=Object(a.a)(s.a.mark((function e(t){var n,c,a,i,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/pictures.json"));case 2:return n=e.sent,e.next=5,n.json();case 5:if(c=e.sent,n.ok){e.next=8;break}throw new Error(c.message||"Could not fetch pictures.");case 8:for(i in a=[],c)c[i].owner===t&&(u=Object(r.a)({id:i},c[i]),a.unshift(u));return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=Object(a.a)(s.a.mark((function e(t){var n,c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/pictures/").concat(t,".json"));case 2:return n=e.sent,e.next=5,n.json();case 5:if(c=e.sent,n.ok){e.next=8;break}throw new Error(c.message||"Could not fetch picture.");case 8:return a=Object(r.a)({id:t},c),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return w.apply(this,arguments)}function w(){return(w=Object(a.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/comments/").concat(t.pictureId,".json"),{method:"POST",body:JSON.stringify(t.content),header:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,n.ok){e.next=8;break}throw new Error(r.message||"Could not add comment.");case 8:return e.abrupt("return",{commentId:r.name});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=Object(a.a)(s.a.mark((function e(t){var n,r,c,a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/comments/").concat(t,".json"));case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,n.ok){e.next=8;break}throw new Error(r.message||"Could not get comments.");case 8:for(a in c=[],r)i={id:a,text:r[a].commentData,commenter:r[a].commenter},c.push(i);return e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(9),c=n(1),s=n.n(c),a=n(0),o=s.a.createContext({token:"",isLoggedIn:!1,userId:"",login:function(e){},logout:function(){}});t.b=function(e){var t=localStorage.getItem("token"),n=localStorage.getItem("userId"),s=Object(c.useState)(n),i=Object(r.a)(s,2),u=i[0],l=i[1],j=Object(c.useState)(t),d=Object(r.a)(j,2),b=d[0],p=d[1],h={token:b,isLoggedIn:!!b,userId:u,login:function(e,t){p(e),l(t),localStorage.setItem("userId",t),localStorage.setItem("token",e)},logout:function(){p(null),l(null),localStorage.removeItem("token"),localStorage.removeItem("userId")}};return Object(a.jsx)(o.Provider,{value:h,children:e.children})}},function(e,t,n){e.exports={auth:"AuthForm_auth__X-8L9",control:"AuthForm_control__MD1Wu",actions:"AuthForm_actions__27KrO",toggle:"AuthForm_toggle__3-Ejt",policy:"AuthForm_policy__20a_G"}},function(e,t,n){"use strict";var r=n(28),c=n.n(r),s=n(0);t.a=function(){return Object(s.jsx)("div",{className:c.a.spinner})}},,,,function(e,t,n){e.exports={headerContainer:"Header_headerContainer__2YkH1",header:"Header_header__2faIG",logo:"Header_logo__1G1kP",nav:"Header_nav__3CRxk"}},,,,,function(e,t,n){"use strict";var r=n(34),c=n.n(r),s=n(0);t.a=function(e){return Object(s.jsxs)("div",{className:c.a.UserInfor,children:[Object(s.jsx)("img",{src:e.image,alt:"profile"}),Object(s.jsx)("p",{children:e.username})]})}},,function(e,t,n){e.exports={main:"Layout_main__3qo5v"}},function(e,t,n){e.exports={spinner:"LoadingSpinner_spinner__2vyCZ"}},,,function(e,t,n){e.exports={pictureList:"PictureList_pictureList__18Gjs"}},function(e,t,n){e.exports={item:"PictureItem_item__3pkfm"}},function(e,t,n){e.exports={noPictureFound:"NoPictureFound_noPictureFound__3MeT8"}},function(e,t,n){e.exports={UserInfor:"UserInfor_UserInfor__1f-IP"}},,,,,function(e,t,n){},,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(26),c=n.n(r),s=(n(39),n(1)),a=n.n(s),o=n(2),i=n(14),u=n(27),l=n.n(u),j=n(5),d=n(12),b=n(13),p=n(20),h=n.n(p),f=n(16),x=n(0),O=function(){var e=Object(s.useContext)(i.a),t=e.userId,n=Object(d.a)(b.f,!0),r=n.sendRequest,c=n.data,a=n.error,o=n.status;if(Object(s.useEffect)((function(){t&&e.isLoggedIn&&r(t)}),[r,t]),e.isLoggedIn){if("pending"===o)return Object(x.jsx)("div",{className:"centered",children:Object(x.jsx)(f.a,{})});if(a)return Object(x.jsx)("p",{className:"centered",children:a})}return Object(x.jsx)("section",{className:h.a.headerContainer,children:Object(x.jsxs)("div",{className:h.a.header,children:[Object(x.jsxs)("h2",{className:h.a.logo,children:["Great",Object(x.jsx)("br",{}),"Pictures"]}),Object(x.jsx)("nav",{className:h.a.nav,children:Object(x.jsxs)("ul",{children:[e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.b,{to:"/pictures",children:Object(x.jsx)("i",{class:"bx bxs-home"})})}),e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.b,{to:"/new-picture",children:Object(x.jsx)("i",{class:"bx bx-plus-circle"})})}),!e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.b,{to:"/login",children:"Login"})}),e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.b,{to:"/".concat(e.userId),children:Object(x.jsx)("img",{src:c.profileImgURL,alt:"header-profile"})})}),e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)("button",{onClick:function(){e.logout()},children:"Logout"})})]})})]})})},m=function(e){return Object(x.jsxs)(a.a.Fragment,{children:[Object(x.jsx)(O,{}),Object(x.jsx)("main",{className:l.a.main,children:e.children})]})},g=n(11),v=n.n(g),_=function(){var e=Object(s.useContext)(i.a);return Object(x.jsxs)("div",{className:v.a.welcome,children:[Object(x.jsxs)("section",{className:v.a.header,children:[Object(x.jsxs)("h1",{className:v.a.logo,children:["Great",Object(x.jsx)("br",{}),"Pictures"]}),Object(x.jsx)("nav",{className:v.a.nav,children:Object(x.jsxs)("ul",{children:[e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.c,{to:"/pictures",activeClassName:v.a.active,children:"All Pictures"})}),e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.c,{to:"/new-picture",activeClassName:v.a.active,children:"Add New Picture"})}),!e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)(j.c,{to:"/login",activeClassName:v.a.active,children:"Login"})}),e.isLoggedIn&&Object(x.jsx)("li",{children:Object(x.jsx)("button",{onClick:function(){e.logout()},className:v.a.welcomeButton,children:"Logout"})})]})})]}),Object(x.jsx)("section",{className:v.a.body,children:Object(x.jsx)("h1",{children:"Share your best moments"})}),Object(x.jsx)("section",{className:v.a.footer,children:Object(x.jsx)("p",{children:"\xa9 2021 GreatPictures"})})]})},w=n(31),y=n.n(w),k=n(32),I=n.n(k),C=function(e){return Object(x.jsx)("div",{className:I.a.item,children:Object(x.jsx)(j.b,{to:"/pictures/".concat(e.id),children:Object(x.jsx)("img",{src:e.img,alt:e.id})})})},S=function(e){var t=e.pictures.map((function(e){return Object(x.jsx)(C,{id:e.id,img:e.image,description:e.description,owner:e.owner},e.id)}));return Object(x.jsx)("ul",{className:y.a.pictureList,children:t})},N=n(33),L=n.n(N),E=function(e){return Object(x.jsxs)("div",{className:L.a.noPictureFound,children:[Object(x.jsx)("p",{children:"No picture found!"}),Object(x.jsx)(j.b,{to:"/new-picture",className:"btn",children:"Add New Picture"})]})},P=function(e){var t=Object(d.a)(b.d,!0),n=t.sendRequest,r=t.data,c=t.status,a=t.error;return Object(s.useEffect)((function(){n()}),[n]),"pending"===c?Object(x.jsx)("div",{className:"centered",children:Object(x.jsx)(f.a,{})}):a?Object(x.jsx)("p",{className:"centered",children:a}):"completed"!==c||r&&0!==r.length?Object(x.jsx)("div",{children:Object(x.jsx)(S,{pictures:r})}):Object(x.jsx)(E,{})},R=n(9),F=n(15),T=n.n(F),A=function(){var e=Object(s.useContext)(i.a),t=Object(o.h)(),n=Object(s.useState)(!0),r=Object(R.a)(n,2),c=r[0],a=r[1],u=Object(s.useState)(!1),l=Object(R.a)(u,2),j=l[0],p=l[1],h=Object(s.useState)(""),f=Object(R.a)(h,2),O=f[0],m=f[1],g=Object(s.useState)(""),v=Object(R.a)(g,2),_=v[0],w=v[1],y=Object(s.useState)(""),k=Object(R.a)(y,2),I=k[0],C=k[1],S=Object(s.useState)(""),N=Object(R.a)(S,2),L=N[0],E=N[1],P=Object(d.a)(b.i).sendRequest,F=Object(d.a)(b.h),A=F.sendRequest,U=F.data;Object(s.useEffect)((function(){A(O)}),[O,A]);return Object(x.jsxs)("section",{className:T.a.auth,onSubmit:function(n){var r;n.preventDefault(),p(!0),r=c?"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyCwsdVEx1Rtk-zsDMQru0C36f-qPMzAdyw":"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyCwsdVEx1Rtk-zsDMQru0C36f-qPMzAdyw",fetch(r,{method:"POST",body:JSON.stringify({email:O,password:_,returnSecureToken:!0}),headers:{"Content-type":"application/json"}}).then((function(e){return e.json()})).then((function(n){if(n&&n.error&&n.error.message)throw new Error(n.error.message);c?(e.login(n.idToken,U),t.replace("/pictures")):(P({email:O,username:I,profileImgURL:L}),a(!0))})).catch((function(e){return console.log(e.message)})),p(!1),m(""),w(""),C("")},children:[Object(x.jsx)("h1",{children:c?"Login":"Sign Up"}),Object(x.jsxs)("form",{children:[!c&&Object(x.jsxs)("div",{className:T.a.control,children:[Object(x.jsx)("label",{htmlFor:"profileImg",children:"Profile Image URL"}),Object(x.jsx)("input",{type:"text",id:"profileImg",required:!0,onChange:function(e){E(e.target.value)},value:L})]}),!c&&Object(x.jsxs)("div",{className:T.a.control,children:[Object(x.jsx)("label",{htmlFor:"username",children:"Username"}),Object(x.jsx)("input",{type:"text",id:"username",required:!0,onChange:function(e){C(e.target.value)},value:I})]}),Object(x.jsxs)("div",{className:T.a.control,children:[Object(x.jsx)("label",{htmlFor:"email",children:"Your Email"}),Object(x.jsx)("input",{type:"email",id:"email",required:!0,onChange:function(e){m(e.target.value)},value:O})]}),Object(x.jsxs)("div",{className:T.a.control,children:[Object(x.jsx)("label",{htmlFor:"password",children:"Your Password"}),Object(x.jsx)("input",{type:"password",id:"password",required:!0,onChange:function(e){w(e.target.value)},value:_})]}),Object(x.jsxs)("div",{className:T.a.actions,children:[!j&&Object(x.jsx)("button",{children:c?"Login":"Create Account"}),j&&Object(x.jsx)("p",{className:"centered",children:"Loading..."}),!c&&Object(x.jsx)("p",{className:T.a.policy,children:"By signing up, you agree to our Terms , Data Policy and Cookies Policy"}),Object(x.jsx)("button",{type:"button",className:T.a.toggle,onClick:function(){a((function(e){return!e}))},children:c?"Create new account":"Login with existing account"})]})]})]})},U=function(e){return Object(x.jsx)(a.a.Fragment,{children:Object(x.jsx)(A,{})})},q=n(25),D=function(e){var t=Object(o.i)().userId,n=Object(d.a)(b.g,!0),r=n.sendRequest,c=n.data,i=n.status,u=n.error;Object(s.useEffect)((function(){r(t)}),[r,t]);var l=Object(d.a)(b.f,!0),j=l.sendRequest,p=l.data,h=l.error,O=l.status;return Object(s.useEffect)((function(){j(t)}),[j,t]),"pending"===i||"pending"===O?Object(x.jsx)("div",{className:"centered",children:Object(x.jsx)(f.a,{})}):u||h?Object(x.jsxs)("p",{className:"centered",children:[u," ",Object(x.jsx)("br",{})," ",h]}):"completed"!==i||c&&0!==c.length?Object(x.jsxs)(a.a.Fragment,{children:[Object(x.jsx)(q.a,{image:p.profileImgURL,username:p.username}),Object(x.jsx)(S,{pictures:c})]}):Object(x.jsx)(E,{})},W=a.a.lazy((function(){return n.e(4).then(n.bind(null,58))})),M=a.a.lazy((function(){return n.e(3).then(n.bind(null,57))}));Object({NODE_ENV:"production",PUBLIC_URL:"/great-pictures",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_FIREBASE_KEY;var z=function(){var e=Object(s.useContext)(i.a);return Object(x.jsxs)(o.e,{children:[Object(x.jsx)(o.c,{path:"/",exact:!0,children:Object(x.jsx)(_,{})}),Object(x.jsx)(m,{children:Object(x.jsx)(s.Suspense,{fallback:Object(x.jsx)("div",{className:"centered",children:Object(x.jsx)(f.a,{})}),children:Object(x.jsxs)(o.e,{children:[e.isLoggedIn&&Object(x.jsx)(o.c,{exact:!0,path:"/pictures",children:Object(x.jsx)(P,{})}),e.isLoggedIn&&Object(x.jsx)(o.c,{path:"/new-picture",children:Object(x.jsx)(W,{})}),e.isLoggedIn&&Object(x.jsx)(o.c,{path:"/pictures/:pictureId",children:Object(x.jsx)(M,{})}),Object(x.jsx)(o.c,{path:"/login",children:Object(x.jsx)(U,{})}),e.isLoggedIn&&Object(x.jsx)(o.c,{path:"/:userId",children:Object(x.jsx)(D,{})}),Object(x.jsx)(o.c,{path:"*",children:Object(x.jsx)(o.b,{to:"/"})})]})})})]})};c.a.render(Object(x.jsx)(i.b,{children:Object(x.jsx)(j.a,{children:Object(x.jsx)(z,{})})}),document.getElementById("root"))}],[[47,1,2]]]);
//# sourceMappingURL=main.d1cf0b11.chunk.js.map